{"version":3,"sources":["../../src/components/searchBox.js"],"names":[],"mappings":"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","file":"searchBox.js","sourcesContent":["import React from 'react';\nimport ReactDom from 'react-dom';\n\nclass SearchBox extends React.Component {\n    constructor(props) {\n        super(props);\n        this.displayName = 'SearchBox';\n        this.state = {\n        \tsearchBox : null,\n        \tinternalPosition : -1\n        }\n        this.postRender = this.postRender.bind(this);\n        this.preRender = this.preRender.bind(this);\n        this.boundsListener = null;\n        this.placesListener = null;\n        this.timer = null;\n    }\n    componentDidMount() {\n   \t this.postRender();\n    }\n    postRender() {\n    \tvar {map, maps, position} = this.props;\n    \tif(map && maps) {\n\t    \tvar input = ReactDom.findDOMNode(this.refs.input);\n\t    \tvar container = ReactDom.findDOMNode(this.refs.child);\n\t    \tvar searchBox = new maps.places.SearchBox(input);\n\t    \t\n            this.timer = null;\n\n            if(this.boundsListener)\n                this.boundsListener.remove();\n            if(this.placesListener)\n                this.placesListener.remove();\n\n\t    \tthis.boundsListener = map.addListener('bounds_changed', () => {\n                if(this.timer) {\n                    clearTimeout(this.timer);\n                }\n                this.timer = setTimeout(() => {\n                    const map_bounds = map.getBounds();\n                    searchBox.setBounds(map_bounds);\n                    \n                    if(typeof this.props.onPlacesChanged === 'function') {\n                        const query = this.refs.input.value;\n                        const service = new maps.places.PlacesService(map);\n                        query ? service.textSearch({\n                            query,\n                            bounds : map_bounds\n                        }, (places, status) => {\n                            if(status == maps.places.PlacesServiceStatus.OK) {\n                                this.props.onPlacesChanged(places);\n                            }\n                        }) : '';\n                    }\n                }, 300);\n\t\t    });\n\n\t\t\tthis.placesListener = searchBox.addListener('places_changed', () => {\n               if(typeof this.props.onPlacesChanged === 'function')\n\t               this.props.onPlacesChanged(searchBox.getPlaces());\n            });\n\n\t    \tif(!position)\n\t    \t\tposition = \"TOP_LEFT\";\n\n\t    \tif(this.state.internalPosition < 0)\n\t\t\t\tmap.controls[maps.ControlPosition[position]].push(container);\n\t\t\telse\n\t\t\t\tmap.controls[maps.ControlPosition[position]].insertAt(this.state.internalPosition, container);\n\n\t\t\tvar internalPosition = map.controls[maps.ControlPosition[position]].length-1;\n\n\t\t\tif(this.state.internalPosition != internalPosition)\n\t\t\t\tthis.setState({\n\t\t\t\t\tinternalPosition\n\t\t\t\t});\n    \t}\n    \telse\n    \t\tconsole.warn(new Error(\"You must pass this component as a control to a Map component.\"))\n    }\n    preRender() {\n    \tvar {map, maps, position} = this.props;\n    \tvar {internalPosition} = this.state;\n\t\tmap.controls[maps.ControlPosition[position]].removeAt(internalPosition);\n\n\t\tvar child = ReactDom.findDOMNode(this.refs.child);\n\t\tvar parent = ReactDom.findDOMNode(this.refs.parent);\n\t\tparent.appendChild(child);\n    }\n    componentWillUpdate() {\n    \tif(this.state.internalPosition > -1)\n\t    \tthis.preRender();\n    }\n    shouldComponentUpdate(nextProps, nextState) {\n    \treturn false;\n    }\n    componentDidUpdate(prevProps, prevState) {\n    \tif(this.state.internalPosition > -1 && prevState.internalPosition != -1)\n\t    \tthis.postRender();\n    }\n    componentWillUnmount() {\n   \t \tthis.preRender();\n    }\n    render() {\n    \tvar Wrapper = this.props.wrapper;\n    \tif(Wrapper)\n    \t\treturn <div ref=\"parent\"><div ref=\"child\"><Wrapper><input type=\"text\" ref=\"input\" placeholder={this.props.placeholder} style={this.props.style} className={this.props.className} /></Wrapper></div></div>\n    \telse\n\t        return <div ref=\"parent\"><div ref=\"child\"><input type=\"text\" ref=\"input\" placeholder={this.props.placeholder} style={this.props.style} className={this.props.className} /></div></div>;\n    }\n}\n\nSearchBox.PropTypes = {\n    placeholder : React.PropTypes.string,\n\tposition : React.PropTypes.string.isRequired,\n\twrapper : React.PropTypes.func,\n\tonPlacesChanged : React.PropTypes.func.isRequired\n}\n\nexport default SearchBox;\n"]}